The following ABNF grammar defines the dafka_proto:

    dafka_proto     = *( MSG | RELIABLE | ASK | ANSWER )

    ;  No description

    MSG             = signature %d'm' content
    signature       = %xAA %xA0             ; two octets
    content         = frame                 ;

    ;  No description

    RELIABLE        = signature %d'r' address sequence content
    address         = string                ;
    sequence        = number-8              ;
    content         = frame                 ;

    ;  No description

    ASK             = signature %d'a' subject sequence address
    subject         = string                ;
    sequence        = number-8              ;
    address         = string                ;

    ;  No description

    ANSWER          = signature %d'w' subject address sequence content
    subject         = string                ;
    address         = string                ;
    sequence        = number-8              ;
    content         = frame                 ;

    ; A frame is zero or more octets encoded as a ZeroMQ frame
    frame           = *OCTET

    ; Strings are always length + text contents
    string          = number-1 *VCHAR

    ; Numbers are unsigned integers in network byte order
    number-1        = 1OCTET
    number-8        = 8OCTET
